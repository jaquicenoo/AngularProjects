{"version":3,"file":"bootstrap-confirmation.js","sources":["../src/popover.js","../src/confirmation.js"],"sourcesContent":["import $ from 'jquery';\nimport 'bootstrap';\n\nif (typeof $.fn.popover === 'undefined' || $.fn.popover.Constructor.VERSION.split('.').shift() !== '4') {\n  throw new Error('Bootstrap Confirmation 4 requires Bootstrap Popover 4');\n}\n\nconst Popover = $.fn.popover.Constructor;\n\nexport default Popover;\n","import $ from 'jquery';\nimport Popover from 'bootstrap/js/src/popover';\n\n/**\n * ------------------------------------------------------------------------\n * Constants\n * ------------------------------------------------------------------------\n */\n\nconst NAME = 'confirmation';\nconst VERSION = '4.0.3';\nconst DATA_KEY = `bs.${NAME}`;\nconst EVENT_KEY = `.${DATA_KEY}`;\nconst JQUERY_NO_CONFLICT = $.fn[NAME];\nconst BTN_CLASS_DEFAULT = 'btn btn-sm h-100 d-flex align-items-center';\n\nconst DefaultType = {\n  ...Popover.DefaultType,\n  singleton           : 'boolean',\n  popout              : 'boolean',\n  copyAttributes      : '(string|array)',\n  onConfirm           : 'function',\n  onCancel            : 'function',\n  btnOkClass          : 'string',\n  btnOkLabel          : 'string',\n  btnOkIconClass      : 'string',\n  btnOkIconContent    : 'string',\n  btnCancelClass      : 'string',\n  btnCancelLabel      : 'string',\n  btnCancelIconClass  : 'string',\n  btnCancelIconContent: 'string',\n  buttons             : 'array',\n};\n\nconst Default = {\n  ...Popover.Default,\n  _attributes         : {},\n  _selector           : null,\n  placement           : 'top',\n  title               : 'Are you sure?',\n  trigger             : 'click',\n  confirmationEvent   : undefined,\n  content             : '',\n  singleton           : false,\n  popout              : false,\n  copyAttributes      : 'href target',\n  onConfirm           : $.noop,\n  onCancel            : $.noop,\n  btnOkClass          : 'btn-primary',\n  btnOkLabel          : 'Yes',\n  btnOkIconClass      : '',\n  btnOkIconContent    : '',\n  btnCancelClass      : 'btn-secondary',\n  btnCancelLabel      : 'No',\n  btnCancelIconClass  : '',\n  btnCancelIconContent: '',\n  buttons             : [],\n  // @formatter:off\n  // href=\"#\" allows the buttons to be focused\n  template            : `\n<div class=\"popover confirmation\">\n  <div class=\"arrow\"></div>\n  <h3 class=\"popover-header\"></h3>\n  <div class=\"popover-body\">\n    <p class=\"confirmation-content\"></p>\n    <div class=\"confirmation-buttons text-center\">\n      <div class=\"btn-group\">\n        <a href=\"#\" class=\"${BTN_CLASS_DEFAULT}\" data-apply=\"confirmation\"></a>\n        <a href=\"#\" class=\"${BTN_CLASS_DEFAULT}\" data-dismiss=\"confirmation\"></a>\n      </div>\n    </div>\n  </div>\n</div>`,\n  // @formatter:on\n};\n\nif (Default.whiteList) {\n  Default.whiteList['*'].push('data-apply', 'data-dismiss');\n}\n\nconst ClassName = {\n  FADE: 'fade',\n  SHOW: 'show',\n};\n\nconst Selector = {\n  TITLE      : '.popover-header',\n  CONTENT    : '.confirmation-content',\n  BUTTONS    : '.confirmation-buttons .btn-group',\n  BTN_APPLY  : '[data-apply=confirmation]',\n  BTN_DISMISS: '[data-dismiss=confirmation]',\n};\n\nconst Keymap = {\n  13: 'Enter',\n  27: 'Escape',\n  39: 'ArrowRight',\n  40: 'ArrowDown',\n};\n\nconst Event = {\n  HIDE      : `hide${EVENT_KEY}`,\n  HIDDEN    : `hidden${EVENT_KEY}`,\n  SHOW      : `show${EVENT_KEY}`,\n  SHOWN     : `shown${EVENT_KEY}`,\n  INSERTED  : `inserted${EVENT_KEY}`,\n  CLICK     : `click${EVENT_KEY}`,\n  FOCUSIN   : `focusin${EVENT_KEY}`,\n  FOCUSOUT  : `focusout${EVENT_KEY}`,\n  MOUSEENTER: `mouseenter${EVENT_KEY}`,\n  MOUSELEAVE: `mouseleave${EVENT_KEY}`,\n  CONFIRMED : `confirmed${EVENT_KEY}`,\n  CANCELED  : `canceled${EVENT_KEY}`,\n  KEYUP     : `keyup${EVENT_KEY}`,\n};\n\n/**\n * ------------------------------------------------------------------------\n * Class Definition\n * ------------------------------------------------------------------------\n */\n\n// keep track of the last openned confirmation for keyboard navigation\nlet activeConfirmation;\n\nclass Confirmation extends Popover {\n  // Getters\n\n  static get VERSION() {\n    return VERSION;\n  }\n\n  static get Default() {\n    return Default;\n  }\n\n  static get NAME() {\n    return NAME;\n  }\n\n  static get DATA_KEY() {\n    return DATA_KEY;\n  }\n\n  static get Event() {\n    return Event;\n  }\n\n  static get EVENT_KEY() {\n    return EVENT_KEY;\n  }\n\n  static get DefaultType() {\n    return DefaultType;\n  }\n\n  // Constructor\n\n  constructor(element, config) {\n    super(element, config);\n\n    if ((this.config.popout || this.config.singleton) && !this.config.rootSelector) {\n      throw new Error('The rootSelector option is required to use popout and singleton features since jQuery 3.');\n    }\n\n    // keep trace of selectors\n    this._isDelegate = false;\n\n    if (config.selector) { // container of buttons\n      config._selector = `${config.rootSelector} ${config.selector}`;\n      this.config._selector = config._selector;\n    }\n    else if (config._selector) { // children of container\n      this.config._selector = config._selector;\n      this._isDelegate = true;\n    }\n    else { // standalone\n      this.config._selector = config.rootSelector;\n    }\n\n    if (this.config.confirmationEvent === undefined) {\n      this.config.confirmationEvent = this.config.trigger;\n    }\n\n    if (!this.config.selector) {\n      this._copyAttributes();\n    }\n\n    this._setConfirmationListeners();\n  }\n\n  // Overrides\n\n  isWithContent() {\n    return true;\n  }\n\n  setContent() {\n    const $tip = $(this.getTipElement());\n    let content = this._getContent();\n\n    if (typeof content === 'function') {\n      content = content.call(this.element);\n    }\n\n    this.setElementContent($tip.find(Selector.TITLE), this.getTitle());\n\n    $tip.find(Selector.CONTENT).toggle(!!content);\n    if (content) {\n      this.setElementContent($tip.find(Selector.CONTENT), content);\n    }\n\n    if (this.config.buttons.length > 0) {\n      this._setCustomButtons($tip);\n    }\n    else {\n      this._setStandardButtons($tip);\n    }\n\n    $tip.removeClass(`${ClassName.FADE} ${ClassName.SHOW}`);\n\n    this._setupKeyupEvent();\n  }\n\n  dispose() {\n    this._cleanKeyupEvent();\n    super.dispose();\n  }\n\n  hide(callback) {\n    this._cleanKeyupEvent();\n    super.hide(callback);\n  }\n\n  // Private\n\n  /**\n   * Copy the value of `copyAttributes` on the config object\n   * @private\n   */\n  _copyAttributes() {\n    this.config._attributes = {};\n    if (this.config.copyAttributes) {\n      if (typeof this.config.copyAttributes === 'string') {\n        this.config.copyAttributes = this.config.copyAttributes.split(' ');\n      }\n    }\n    else {\n      this.config.copyAttributes = [];\n    }\n\n    this.config.copyAttributes.forEach((attr) => {\n      this.config._attributes[attr] = $(this.element).attr(attr);\n    });\n  }\n\n  /**\n   * Custom event listeners for popouts and singletons\n   * @private\n   */\n  _setConfirmationListeners() {\n    const self = this;\n\n    if (!this.config.selector) {\n      // cancel original event\n      $(this.element).on(this.config.trigger, (e, ack) => {\n        if (!ack) {\n          e.preventDefault();\n          e.stopPropagation();\n          e.stopImmediatePropagation();\n        }\n      });\n\n      // manage singleton\n      $(this.element).on(Event.SHOWN, function () {\n        if (self.config.singleton) {\n          // close all other popover already initialized\n          $(self.config._selector).not($(this)).filter(function () {\n            return $(this).data(DATA_KEY) !== undefined;\n          }).confirmation('hide');\n        }\n      });\n    }\n    else {\n      // cancel original event\n      $(this.element).on(this.config.trigger, this.config.selector, (e, ack) => {\n        if (!ack) {\n          e.preventDefault();\n          e.stopPropagation();\n          e.stopImmediatePropagation();\n        }\n      });\n    }\n\n    if (!this._isDelegate) {\n      // manage popout\n      this.eventBody = false;\n      this.uid = this.element.id || Confirmation.getUID(`${NAME}_group`);\n\n      $(this.element).on(Event.SHOWN, () => {\n        if (self.config.popout && !self.eventBody) {\n          self.eventBody = $('body').on(`${Event.CLICK}.${self.uid}`, (e) => {\n            if ($(self.config._selector).is(e.target)) {\n              return;\n            }\n            // close all popover already initialized\n            $(self.config._selector).filter(function () {\n              return $(this).data(DATA_KEY) !== undefined;\n            }).confirmation('hide');\n\n            $('body').off(`${Event.CLICK}.${self.uid}`);\n            self.eventBody = false;\n          });\n        }\n      });\n    }\n  }\n\n  /**\n   * Init the standard ok/cancel buttons\n   * @param $tip\n   * @private\n   */\n  _setStandardButtons($tip) {\n    const self = this;\n\n    const btnApply = $tip.find(Selector.BTN_APPLY)\n      .addClass(this.config.btnOkClass)\n      .html(this.config.btnOkLabel)\n      .attr(this.config._attributes);\n\n    if (this.config.btnOkIconClass || this.config.btnOkIconContent) {\n      btnApply.prepend($('<i></i>')\n        .addClass(this.config.btnOkIconClass || '')\n        .text(this.config.btnOkIconContent || ''));\n    }\n\n    btnApply.off('click')\n      .one('click', function (e) {\n        if ($(this).attr('href') === '#') {\n          e.preventDefault();\n        }\n\n        self.config.onConfirm.call(self.element);\n        $(self.element).trigger(Event.CONFIRMED);\n        $(self.element).trigger(self.config.confirmationEvent, [true]);\n\n        self.hide();\n      });\n\n    const btnDismiss = $tip.find(Selector.BTN_DISMISS)\n      .addClass(this.config.btnCancelClass)\n      .html(this.config.btnCancelLabel);\n\n    if (this.config.btnCancelIconClass || this.config.btnCancelIconContent) {\n      btnDismiss.prepend($('<i></i>')\n        .addClass(this.config.btnCancelIconClass || '')\n        .text(this.config.btnCancelIconContent || ''));\n    }\n\n    btnDismiss.off('click')\n      .one('click', (e) => {\n        e.preventDefault();\n\n        self.config.onCancel.call(self.element);\n        $(self.element).trigger(Event.CANCELED);\n\n        self.hide();\n      });\n  }\n\n  /**\n   * Init the custom buttons\n   * @param $tip\n   * @private\n   */\n  _setCustomButtons($tip) {\n    const self = this;\n    const $group = $tip.find(Selector.BUTTONS).empty();\n\n    this.config.buttons.forEach((button) => {\n      const btn = $('<a href=\"#\"></a>')\n        .addClass(BTN_CLASS_DEFAULT)\n        .addClass(button.class || 'btn btn-secondary')\n        .html(button.label || '')\n        .attr(button.attr || {});\n\n      if (button.iconClass || button.iconContent) {\n        btn.prepend($('<i></i>')\n          .addClass(button.iconClass || '')\n          .text(button.iconContent || ''));\n      }\n\n      btn.one('click', function (e) {\n        if ($(this).attr('href') === '#') {\n          e.preventDefault();\n        }\n\n        if (button.onClick) {\n          button.onClick.call($(self.element));\n        }\n\n        if (button.cancel) {\n          self.config.onCancel.call(self.element, button.value);\n          $(self.element).trigger(Event.CANCELED, [button.value]);\n        }\n        else {\n          self.config.onConfirm.call(self.element, button.value);\n          $(self.element).trigger(Event.CONFIRMED, [button.value]);\n        }\n\n        self.hide();\n      });\n\n      $group.append(btn);\n    });\n  }\n\n  /**\n   * Install the keyboatd event handler\n   * @private\n   */\n  _setupKeyupEvent() {\n    activeConfirmation = this;\n    $(window)\n      .off(Event.KEYUP)\n      .on(Event.KEYUP, this._onKeyup.bind(this));\n  }\n\n  /**\n   * Remove the keyboard event handler\n   * @private\n   */\n  _cleanKeyupEvent() {\n    if (activeConfirmation === this) {\n      activeConfirmation = undefined;\n      $(window).off(Event.KEYUP);\n    }\n  }\n\n  /**\n   * Event handler for keyboard navigation\n   * @param event\n   * @private\n   */\n  _onKeyup(event) {\n    if (!this.tip) {\n      this._cleanKeyupEvent();\n      return;\n    }\n\n    const $tip = $(this.getTipElement());\n    const key = event.key || Keymap[event.keyCode || event.which];\n\n    const $group = $tip.find(Selector.BUTTONS);\n    const $active = $group.find('.active');\n    let $next;\n\n    switch (key) {\n      case 'Escape':\n        this.hide();\n        break;\n\n      case 'ArrowRight':\n        if ($active.length && $active.next().length) {\n          $next = $active.next();\n        }\n        else {\n          $next = $group.children().first();\n        }\n        $active.removeClass('active');\n        $next.addClass('active').focus();\n        break;\n\n      case 'ArrowLeft':\n        if ($active.length && $active.prev().length) {\n          $next = $active.prev();\n        }\n        else {\n          $next = $group.children().last();\n        }\n        $active.removeClass('active');\n        $next.addClass('active').focus();\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  // Static\n\n  /**\n   * Generates an uui, copied from Bootrap's utils\n   * @param {string} prefix\n   * @returns {string}\n   */\n  static getUID(prefix) {\n    let uid = prefix;\n    do {\n      // eslint-disable-next-line no-bitwise\n      uid += ~~(Math.random() * 1000000); // \"~~\" acts like a faster Math.floor() here\n    } while (document.getElementById(uid));\n    return uid;\n  }\n\n  static _jQueryInterface(config) {\n    return this.each(function () {\n      let data = $(this).data(DATA_KEY);\n\n      const _config = typeof config === 'object' ? config : {};\n      _config.rootSelector = $(this).selector || _config.rootSelector; // this.selector removed in jQuery > 3\n\n      if (!data && /destroy|hide/.test(config)) {\n        return;\n      }\n\n      if (!data) {\n        data = new Confirmation(this, _config);\n        $(this).data(DATA_KEY, data);\n      }\n\n      if (typeof config === 'string') {\n        if (typeof data[config] === 'undefined') {\n          throw new TypeError(`No method named \"${config}\"`);\n        }\n        data[config]();\n      }\n    });\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n */\n\n$.fn[NAME] = Confirmation._jQueryInterface;\n$.fn[NAME].Constructor = Confirmation;\n$.fn[NAME].noConflict = function () {\n  $.fn[NAME] = JQUERY_NO_CONFLICT;\n  return Confirmation._jQueryInterface;\n};\n\nexport default Confirmation;\n"],"names":["$","fn","popover","Constructor","VERSION","split","shift","Error","Popover","NAME","DATA_KEY","EVENT_KEY","JQUERY_NO_CONFLICT","BTN_CLASS_DEFAULT","DefaultType","singleton","popout","copyAttributes","onConfirm","onCancel","btnOkClass","btnOkLabel","btnOkIconClass","btnOkIconContent","btnCancelClass","btnCancelLabel","btnCancelIconClass","btnCancelIconContent","buttons","Default","_attributes","_selector","placement","title","trigger","confirmationEvent","undefined","content","noop","template","whiteList","push","ClassName","FADE","SHOW","Selector","TITLE","CONTENT","BUTTONS","BTN_APPLY","BTN_DISMISS","Keymap","Event","HIDE","HIDDEN","SHOWN","INSERTED","CLICK","FOCUSIN","FOCUSOUT","MOUSEENTER","MOUSELEAVE","CONFIRMED","CANCELED","KEYUP","activeConfirmation","Confirmation","element","config","rootSelector","_isDelegate","selector","_copyAttributes","_setConfirmationListeners","isWithContent","setContent","$tip","getTipElement","_getContent","call","setElementContent","find","getTitle","toggle","length","_setCustomButtons","_setStandardButtons","removeClass","_setupKeyupEvent","dispose","_cleanKeyupEvent","hide","callback","forEach","attr","self","on","e","ack","preventDefault","stopPropagation","stopImmediatePropagation","not","filter","data","confirmation","eventBody","uid","id","getUID","is","target","off","btnApply","addClass","html","prepend","text","one","btnDismiss","$group","empty","button","btn","class","label","iconClass","iconContent","onClick","cancel","value","append","window","_onKeyup","bind","event","tip","key","keyCode","which","$active","$next","next","children","first","focus","prev","last","prefix","Math","random","document","getElementById","_jQueryInterface","each","_config","test","TypeError","noConflict"],"mappings":"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"}